<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Jan van der Laan" />
  <title>Introduction to working with Data Packages</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <style type="text/css">
body {
max-width: 50rem;
margin-left: auto;
margin-right: auto;
font-family: system-ui;
color: lightgray;
background: #555555;
}
p, li {
text-align: justify;
}
pre {
background: #444;
padding: 0.5rem;
}
h1, h2, h3, h4, h5 {
color: orange;
font-weight: bold;
}
h4, h5 {
color: inherit;
}
h2 {
margin-top: 3rem;
}
a {
color: orange;
}
a:hover {
color: lightblue;
}
pre code {
color: white;
background: inherit;
padding: 0;
}
code {
color: #e5c892;
background: #444;
padding: 0.2rem;
}

p.author {
font-weight : bold;
color: orange;
}

code {
color : lightgray;
}
code span.op {
color: #cccccc;
}
code span.kw, code span.cf {
color: #30bd58;
}
code span.st {
color: #76a9db; }
code span.dv, code span.ot, code span.fl{
color: #7fd0a8; }
code span.dt, code span.er {
color: #ee8c70; }
</style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Introduction to working with Data Packages</h1>
<p class="author">Jan van der Laan</p>
</header>
<!--
%\VignetteEngine{simplermarkdown::mdweave_to_html}
%\VignetteIndexEntry{Introduction to datapackage}
-->
<p>A <a href="https://specs.frictionlessdata.io/">Data Package</a> is collection of files and consists of both data, which can be any type of information such as images and CSV files, and meta data. These files are usually stored in one directory (possibly with sub directories) although links to external data are possible. Meta data is data about data and consists of the information needed by software programmes to use the data and information needed by users of the data such as descriptions, names of authors, licences etc. The meta data is stored in a file in the directory that is usually called <code>datapackage.json</code>. The information in this file is what below will be called the Data Package. As mentioned, it contains both information on the data package itself (title, description) and information on a number of Data Resources. The Data Resources describe the data files in the data package and also consist of information like a title, description, but also information needed by software to use the data such as the path to the data (location of the data), and technical information such as how the data is stored. This information makes it easier to use the data. Below we will show how we can use the information in a Data Package to easily read in the data and work with the data and we will show how we can create a Data Package for our own data.</p>
<h2 id="overview-of-terminology">Overview of terminology</h2>
<p>Below an overview of some of the terminology associated with Data Packages.</p>
<p><strong>Data Package</strong></p>
<ul>
<li>Contains one or more Data Resources.</li>
<li>Has a number of properties like <code>title</code>, <code>name</code> and <code>description</code>.</li>
</ul>
<p><strong>Data Resource</strong></p>
<ul>
<li>Contains data either as inline data in a <code>data</code> property or external data pointed to by a <code>path</code> property.</li>
<li>Has a number of properties, like <code>title,</code>name<code>,</code>encoding`, …</li>
</ul>
<p><strong>Tabular Data Resource</strong></p>
<ul>
<li>Is a Data Resource with an additional set of properties and constraints.</li>
<li>Has a Table Schema.</li>
</ul>
<p><strong>Table Schema</strong></p>
<ul>
<li>Describes a tabular data set (a data set with rows an columns; as usually stored in a <code>data.frame</code> in R).</li>
<li>Has one or more Field Descriptors.</li>
</ul>
<p><strong>Field Descriptor</strong></p>
<ul>
<li>Describes a Field (a column) in a tabular data set.</li>
<li>Has number of properties like, <code>name</code> and <code>type</code>.</li>
</ul>
<h2 id="getting-information-from-a-data-package">Getting information from a Data Package</h2>
<p>Below we open an example Data Package that comes with the package:</p>
<div class="sourceCode" id="g1"><pre class="sourceCode R"><code class="sourceCode r"><span id="g1-1"><a href="#g1-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(datapackage, <span class="dt">warn.conflicts =</span> <span class="ot">FALSE</span>)</span>
<span id="g1-2"><a href="#g1-2" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span>dir &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;examples/iris&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;datapackage&quot;</span>)</span>
<span id="g1-3"><a href="#g1-3" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span>dp &lt;-<span class="st"> </span><span class="kw">opendatapackage</span>(dir)</span>
<span id="g1-4"><a href="#g1-4" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">print</span>(dp)</span>
<span id="g1-5"><a href="#g1-5" aria-hidden="true"></a>[iris<span class="op">-</span>example] An example data package with the iris data set</span>
<span id="g1-6"><a href="#g1-6" aria-hidden="true"></a></span>
<span id="g1-7"><a href="#g1-7" aria-hidden="true"></a>A description</span>
<span id="g1-8"><a href="#g1-8" aria-hidden="true"></a>...</span>
<span id="g1-9"><a href="#g1-9" aria-hidden="true"></a></span>
<span id="g1-10"><a href="#g1-10" aria-hidden="true"></a>Location<span class="op">:</span><span class="st"> </span><span class="er">&lt;/</span>tmp<span class="op">/</span>RtmpouPo99<span class="op">/</span>Rinst13e9a37cb6e3e<span class="op">/</span>datapackage<span class="op">/</span>examples<span class="op">/</span>iris<span class="op">&gt;</span></span>
<span id="g1-11"><a href="#g1-11" aria-hidden="true"></a>Resources<span class="op">:</span></span>
<span id="g1-12"><a href="#g1-12" aria-hidden="true"></a>[iris] The iris data set</span>
<span id="g1-13"><a href="#g1-13" aria-hidden="true"></a>[complex] A complex example dataset</span>
<span id="g1-14"><a href="#g1-14" aria-hidden="true"></a>[codelist<span class="op">-</span>factor1] Codelist <span class="cf">for</span> the factor1 field <span class="cf">in</span> the complex resource</span>
<span id="g1-15"><a href="#g1-15" aria-hidden="true"></a>[codelist<span class="op">-</span>factor2] </span>
<span id="g1-16"><a href="#g1-16" aria-hidden="true"></a>[inline] An inline data set</span>
<span id="g1-17"><a href="#g1-17" aria-hidden="true"></a>[fixed<span class="op">-</span>width] A Fixed Width Example</span></code></pre></div>
<p>The print statement shows the name of the package, <code>iris-example</code>, the title, the first paragraph of the description, the location of the Data Package and the Data Resources in the package. In this case there are two Data Resources:</p>
<div class="sourceCode" id="g2"><pre class="sourceCode R"><code class="sourceCode r"><span id="g2-1"><a href="#g2-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">dpnresources</span>(dp)</span>
<span id="g2-2"><a href="#g2-2" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="dv">6</span></span></code></pre></div>
<p>The names are</p>
<div class="sourceCode" id="g3"><pre class="sourceCode R"><code class="sourceCode r"><span id="g3-1"><a href="#g3-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">dpresourcenames</span>(dp)</span>
<span id="g3-2"><a href="#g3-2" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="st">&quot;iris&quot;</span>             <span class="st">&quot;complex&quot;</span>          <span class="st">&quot;codelist-factor1&quot;</span> <span class="st">&quot;codelist-factor2&quot;</span></span>
<span id="g3-3"><a href="#g3-3" aria-hidden="true"></a>[<span class="dv">5</span>] <span class="st">&quot;inline&quot;</span>           <span class="st">&quot;fixed-width&quot;</span>     </span></code></pre></div>
<p>Using the <code>resource</code> methode on can obtain the Data Resource</p>
<div class="sourceCode" id="g4"><pre class="sourceCode R"><code class="sourceCode r"><span id="g4-1"><a href="#g4-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span>iris &lt;-<span class="st"> </span><span class="kw">dpresource</span>(dp, <span class="st">&quot;iris&quot;</span>)</span>
<span id="g4-2"><a href="#g4-2" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">print</span>(iris)</span>
<span id="g4-3"><a href="#g4-3" aria-hidden="true"></a>[iris] The iris data set</span>
<span id="g4-4"><a href="#g4-4" aria-hidden="true"></a></span>
<span id="g4-5"><a href="#g4-5" aria-hidden="true"></a>A description of the iris data set</span>
<span id="g4-6"><a href="#g4-6" aria-hidden="true"></a>...</span>
<span id="g4-7"><a href="#g4-7" aria-hidden="true"></a></span>
<span id="g4-8"><a href="#g4-8" aria-hidden="true"></a>Selected properties<span class="op">:</span></span>
<span id="g4-9"><a href="#g4-9" aria-hidden="true"></a>path     <span class="op">:</span><span class="st">&quot;iris.csv&quot;</span></span>
<span id="g4-10"><a href="#g4-10" aria-hidden="true"></a>format   <span class="op">:</span><span class="st">&quot;csv&quot;</span></span>
<span id="g4-11"><a href="#g4-11" aria-hidden="true"></a>mediatype<span class="op">:</span><span class="st">&quot;text/csv&quot;</span></span>
<span id="g4-12"><a href="#g4-12" aria-hidden="true"></a>encoding <span class="op">:</span><span class="st">&quot;utf-8&quot;</span></span></code></pre></div>
<p>The <code>print</code> statement again shows the name, title and description. It also shows that the data is in a CSV-file anmes <code>iris.csv</code>. Standard the <code>print</code> shows only a few properties of the Data Resource. To show all properties:</p>
<div class="sourceCode" id="g5"><pre class="sourceCode R"><code class="sourceCode r"><span id="g5-1"><a href="#g5-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">print</span>(iris, <span class="dt">properties =</span> <span class="ot">NA</span>)</span>
<span id="g5-2"><a href="#g5-2" aria-hidden="true"></a>[iris] The iris data set</span>
<span id="g5-3"><a href="#g5-3" aria-hidden="true"></a></span>
<span id="g5-4"><a href="#g5-4" aria-hidden="true"></a>A description of the iris data set</span>
<span id="g5-5"><a href="#g5-5" aria-hidden="true"></a>...</span>
<span id="g5-6"><a href="#g5-6" aria-hidden="true"></a></span>
<span id="g5-7"><a href="#g5-7" aria-hidden="true"></a>Selected properties<span class="op">:</span></span>
<span id="g5-8"><a href="#g5-8" aria-hidden="true"></a>path     <span class="op">:</span><span class="st">&quot;iris.csv&quot;</span></span>
<span id="g5-9"><a href="#g5-9" aria-hidden="true"></a>format   <span class="op">:</span><span class="st">&quot;csv&quot;</span></span>
<span id="g5-10"><a href="#g5-10" aria-hidden="true"></a>mediatype<span class="op">:</span><span class="st">&quot;text/csv&quot;</span></span>
<span id="g5-11"><a href="#g5-11" aria-hidden="true"></a>encoding <span class="op">:</span><span class="st">&quot;utf-8&quot;</span></span></code></pre></div>
<p>Using this information it should be possible to open the dataset. The data can be opened in R using the <code>dpgetdata</code> method. Based on the information in the Data Resource this function will try to open the dataset using the correct functions in R (in this case <code>read.csv</code>):</p>
<div class="sourceCode" id="g6"><pre class="sourceCode R"><code class="sourceCode r"><span id="g6-1"><a href="#g6-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span>dta &lt;-<span class="st"> </span><span class="kw">dpgetdata</span>(iris)</span>
<span id="g6-2"><a href="#g6-2" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(dta)</span>
<span id="g6-3"><a href="#g6-3" aria-hidden="true"></a>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span id="g6-4"><a href="#g6-4" aria-hidden="true"></a><span class="dv">1</span>          <span class="fl">5.1</span>         <span class="fl">3.5</span>          <span class="fl">1.4</span>         <span class="fl">0.2</span>  setosa</span>
<span id="g6-5"><a href="#g6-5" aria-hidden="true"></a><span class="dv">2</span>          <span class="fl">4.9</span>         <span class="fl">3.0</span>          <span class="fl">1.4</span>         <span class="fl">0.2</span>  setosa</span>
<span id="g6-6"><a href="#g6-6" aria-hidden="true"></a><span class="dv">3</span>          <span class="fl">4.7</span>         <span class="fl">3.2</span>          <span class="fl">1.3</span>         <span class="fl">0.2</span>  setosa</span>
<span id="g6-7"><a href="#g6-7" aria-hidden="true"></a><span class="dv">4</span>          <span class="fl">4.6</span>         <span class="fl">3.1</span>          <span class="fl">1.5</span>         <span class="fl">0.2</span>  setosa</span>
<span id="g6-8"><a href="#g6-8" aria-hidden="true"></a><span class="dv">5</span>          <span class="fl">5.0</span>         <span class="fl">3.6</span>          <span class="fl">1.4</span>         <span class="fl">0.2</span>  setosa</span>
<span id="g6-9"><a href="#g6-9" aria-hidden="true"></a><span class="dv">6</span>          <span class="fl">5.4</span>         <span class="fl">3.9</span>          <span class="fl">1.7</span>         <span class="fl">0.4</span>  setosa</span></code></pre></div>
<p>It is also possible to import the data directly from the Data Package object by specifying the resource for which the data needs to be imported.</p>
<div class="sourceCode" id="g7"><pre class="sourceCode R"><code class="sourceCode r"><span id="g7-1"><a href="#g7-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span>dta &lt;-<span class="st"> </span><span class="kw">dpgetdata</span>(dp, <span class="st">&quot;iris&quot;</span>)</span></code></pre></div>
<p>The <code>dpgetdata</code> method only supports a limited set of data formats. It is possible to also provide a custum function to read the data using the <code>reader</code> argument of <code>dpgetdata</code>. However, it is also possible to import the data ‘manually’ using the information in the Data Package. The path of the file in a Data Resource can be obtained using the <code>path</code> method:</p>
<div class="sourceCode" id="g8"><pre class="sourceCode R"><code class="sourceCode r"><span id="g8-1"><a href="#g8-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">dppath</span>(iris)</span>
<span id="g8-2"><a href="#g8-2" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="st">&quot;iris.csv&quot;</span></span></code></pre></div>
<p>By default this will return the path as defined in the Data Package. This either a path relative to the directory in which the Data Package is located or a URL. To open a file inside the Data Package one also needs the location of the Data Package. This is stored in the <code>path</code> attribute of the Data Package and Resource:</p>
<div class="sourceCode" id="g9"><pre class="sourceCode R"><code class="sourceCode r"><span id="g9-1"><a href="#g9-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">attr</span>(dp, <span class="st">&quot;path&quot;</span>)</span>
<span id="g9-2"><a href="#g9-2" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="st">&quot;/tmp/RtmpouPo99/Rinst13e9a37cb6e3e/datapackage/examples/iris&quot;</span></span>
<span id="g9-3"><a href="#g9-3" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">attr</span>(iris, <span class="st">&quot;path&quot;</span>)</span>
<span id="g9-4"><a href="#g9-4" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="st">&quot;/tmp/RtmpouPo99/Rinst13e9a37cb6e3e/datapackage/examples/iris&quot;</span></span></code></pre></div>
<p>Using the <code>fullpath = TRUE</code> argument, <code>path</code> will return the full path to the file:</p>
<div class="sourceCode" id="g10"><pre class="sourceCode R"><code class="sourceCode r"><span id="g10-1"><a href="#g10-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span>fn &lt;-<span class="st"> </span><span class="kw">dppath</span>(iris, <span class="dt">fullpath =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>This path can be used to open the file manually:</p>
<div class="sourceCode" id="g11"><pre class="sourceCode R"><code class="sourceCode r"><span id="g11-1"><a href="#g11-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span>dta &lt;-<span class="st"> </span><span class="kw">read.csv</span>(fn)</span>
<span id="g11-2"><a href="#g11-2" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(dta)</span>
<span id="g11-3"><a href="#g11-3" aria-hidden="true"></a>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span id="g11-4"><a href="#g11-4" aria-hidden="true"></a><span class="dv">1</span>          <span class="fl">5.1</span>         <span class="fl">3.5</span>          <span class="fl">1.4</span>         <span class="fl">0.2</span>  setosa</span>
<span id="g11-5"><a href="#g11-5" aria-hidden="true"></a><span class="dv">2</span>          <span class="fl">4.9</span>         <span class="fl">3.0</span>          <span class="fl">1.4</span>         <span class="fl">0.2</span>  setosa</span>
<span id="g11-6"><a href="#g11-6" aria-hidden="true"></a><span class="dv">3</span>          <span class="fl">4.7</span>         <span class="fl">3.2</span>          <span class="fl">1.3</span>         <span class="fl">0.2</span>  setosa</span>
<span id="g11-7"><a href="#g11-7" aria-hidden="true"></a><span class="dv">4</span>          <span class="fl">4.6</span>         <span class="fl">3.1</span>          <span class="fl">1.5</span>         <span class="fl">0.2</span>  setosa</span>
<span id="g11-8"><a href="#g11-8" aria-hidden="true"></a><span class="dv">5</span>          <span class="fl">5.0</span>         <span class="fl">3.6</span>          <span class="fl">1.4</span>         <span class="fl">0.2</span>  setosa</span>
<span id="g11-9"><a href="#g11-9" aria-hidden="true"></a><span class="dv">6</span>          <span class="fl">5.4</span>         <span class="fl">3.9</span>          <span class="fl">1.7</span>         <span class="fl">0.4</span>  setosa</span></code></pre></div>
<p>Note that the <code>path</code> property of a Data Resource can be a vector of paths in case a single data set is stored in a set of files. It is assumed then that the files have the same format. Therefore, <code>rbind</code> should work on these files.</p>
<p>Below is an alternative way of importing the data belonging to a Data Resource. Here we use the pipe operator to chain the various commands to import the ‘inline’ data set. In this example data set the data is stored inside the Data Package.</p>
<div class="sourceCode" id="g12"><pre class="sourceCode R"><code class="sourceCode r"><span id="g12-1"><a href="#g12-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span>dta &lt;-<span class="st"> </span><span class="kw">dpresource</span>(dp, <span class="st">&quot;inline&quot;</span>) <span class="op">|</span><span class="er">&gt;</span><span class="st"> </span><span class="kw">dpgetdata</span>()</span>
<span id="g12-2"><a href="#g12-2" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(dta)</span>
<span id="g12-3"><a href="#g12-3" aria-hidden="true"></a>  field1 field2</span>
<span id="g12-4"><a href="#g12-4" aria-hidden="true"></a><span class="dv">1</span>     <span class="dv">10</span>     <span class="dv">20</span></span>
<span id="g12-5"><a href="#g12-5" aria-hidden="true"></a><span class="dv">2</span>     <span class="dv">20</span>     <span class="dv">21</span></span>
<span id="g12-6"><a href="#g12-6" aria-hidden="true"></a><span class="dv">3</span>     <span class="dv">30</span>     <span class="dv">22</span></span></code></pre></div>
<h2 id="reading-properties-from-data-packages-and-data-resources">Reading properties from Data Packages and Data Resources</h2>
<p>For many of the standard fields of a Data Packages, methods are defined to obtain the values of these fields:</p>
<div class="sourceCode" id="r1"><pre class="sourceCode R"><code class="sourceCode r"><span id="r1-1"><a href="#r1-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">dpname</span>(dp)</span>
<span id="r1-2"><a href="#r1-2" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="st">&quot;iris-example&quot;</span></span>
<span id="r1-3"><a href="#r1-3" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">dpdescription</span>(dp)</span>
<span id="r1-4"><a href="#r1-4" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="st">&quot;A description</span><span class="ch">\n\n</span><span class="st">The second paragraph of the description&quot;</span></span>
<span id="r1-5"><a href="#r1-5" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">dpdescription</span>(dp, <span class="dt">firstparagraph =</span> <span class="ot">TRUE</span>)</span>
<span id="r1-6"><a href="#r1-6" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="st">&quot;A description&quot;</span></span>
<span id="r1-7"><a href="#r1-7" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">dptitle</span>(dp)</span>
<span id="r1-8"><a href="#r1-8" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="st">&quot;An example data package with the iris data set&quot;</span></span></code></pre></div>
<p>The same holds for Data Resources:</p>
<div class="sourceCode" id="r2"><pre class="sourceCode R"><code class="sourceCode r"><span id="r2-1"><a href="#r2-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">dptitle</span>(iris)</span>
<span id="r2-2"><a href="#r2-2" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="st">&quot;The iris data set&quot;</span></span>
<span id="r2-3"><a href="#r2-3" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">dpresource</span>(dp, <span class="st">&quot;inline&quot;</span>) <span class="op">|</span><span class="er">&gt;</span><span class="st"> </span><span class="kw">dptitle</span>()</span>
<span id="r2-4"><a href="#r2-4" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="st">&quot;An inline data set&quot;</span></span></code></pre></div>
<p>For <code>datapackage</code> objects there are currently defined the following methods: (this list can be obtained using <code>?properties_datapackage</code>)</p>
<ul>
<li><code>dpname</code></li>
<li><code>dptitle</code></li>
<li><code>dpdescription</code></li>
<li><code>dpkeywords</code></li>
<li><code>dpcreated</code></li>
<li><code>dpid</code></li>
<li><code>dpcontributors</code></li>
</ul>
<p>For <code>dataresource</code> objects there are currently defined the following methods (this list can be obtained using <code>?properties_dataresource</code>)</p>
<ul>
<li><code>dpname</code></li>
<li><code>dptitle</code></li>
<li><code>dpdescription</code></li>
<li><code>dppath</code></li>
<li><code>dpformat</code></li>
<li><code>dpmediatype</code></li>
<li><code>dpencoding</code></li>
<li><code>dpbytes</code></li>
<li><code>dphash</code></li>
</ul>
<p>The <code>dppath</code> method has a <code>fullpath</code> argument that, when used, returns the full path to the Data Resources data and not just the path relative to the Data Package. The full path is needed when one wants to use the path to read the data.</p>
<div class="sourceCode" id="r3"><pre class="sourceCode R"><code class="sourceCode r"><span id="r3-1"><a href="#r3-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">dppath</span>(iris)</span>
<span id="r3-2"><a href="#r3-2" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="st">&quot;iris.csv&quot;</span></span>
<span id="r3-3"><a href="#r3-3" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">dppath</span>(iris, <span class="dt">fullpath =</span> <span class="ot">TRUE</span>)</span>
<span id="r3-4"><a href="#r3-4" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="st">&quot;/tmp/RtmpouPo99/Rinst13e9a37cb6e3e/datapackage/examples/iris/iris.csv&quot;</span></span></code></pre></div>
<p>It is also possible to get other properties than the ones explicitly mentioned above using the <code>dpproperty</code> method:</p>
<div class="sourceCode" id="r4"><pre class="sourceCode R"><code class="sourceCode r"><span id="r4-1"><a href="#r4-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">dpproperty</span>(iris, <span class="st">&quot;encoding&quot;</span>)</span>
<span id="r4-2"><a href="#r4-2" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="st">&quot;utf-8&quot;</span></span></code></pre></div>
<h2 id="working-with-code-lists">Working with Code Lists</h2>
<p>It is possible for fields to have a Code List associated with them. For example in the ‘complex’ example resource, there is a column ‘factor1’:</p>
<div class="sourceCode" id="c1"><pre class="sourceCode R"><code class="sourceCode r"><span id="c1-1"><a href="#c1-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span>complex &lt;-<span class="st"> </span><span class="kw">dpresource</span>(dp, <span class="st">&quot;complex&quot;</span>) <span class="op">|</span><span class="er">&gt;</span><span class="st"> </span><span class="kw">dpgetdata</span>()</span>
<span id="c1-2"><a href="#c1-2" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">print</span>(complex)</span>
<span id="c1-3"><a href="#c1-3" aria-hidden="true"></a>  string1 integer1 boolean1  number1    number2 boolean2      date1 factor1</span>
<span id="c1-4"><a href="#c1-4" aria-hidden="true"></a><span class="dv">1</span>       a        <span class="dv">1</span>     <span class="ot">TRUE</span>  <span class="fl">1.2e+00</span>      <span class="fl">1.200</span>     <span class="ot">TRUE</span> <span class="dv">2020-01-01</span>       <span class="dv">1</span></span>
<span id="c1-5"><a href="#c1-5" aria-hidden="true"></a><span class="dv">2</span>       b     <span class="dv">-100</span>    <span class="ot">FALSE</span> <span class="fl">-1.0e-04</span>     <span class="fl">-0.001</span>    <span class="ot">FALSE</span> <span class="dv">2022-01-12</span>       <span class="dv">2</span></span>
<span id="c1-6"><a href="#c1-6" aria-hidden="true"></a><span class="dv">3</span>       c       <span class="ot">NA</span>     <span class="ot">TRUE</span>      <span class="ot">Inf</span>   <span class="fl">1100.000</span>     <span class="ot">TRUE</span>       <span class="op">&lt;</span><span class="ot">NA</span><span class="op">&gt;</span><span class="st">       </span><span class="dv">1</span></span>
<span id="c1-7"><a href="#c1-7" aria-hidden="true"></a><span class="dv">4</span>              <span class="dv">100</span>     <span class="ot">TRUE</span>  <span class="fl">1.0e+04</span> <span class="fl">-11000.400</span>       <span class="ot">NA</span> <span class="dv">1950-10-10</span>       <span class="dv">3</span></span>
<span id="c1-8"><a href="#c1-8" aria-hidden="true"></a><span class="dv">5</span>       f        <span class="dv">0</span>       <span class="ot">NA</span>      <span class="ot">NaN</span>         <span class="ot">NA</span>    <span class="ot">FALSE</span> <span class="dv">1920-12-10</span>      <span class="ot">NA</span></span>
<span id="c1-9"><a href="#c1-9" aria-hidden="true"></a><span class="dv">6</span>       g        <span class="dv">0</span>    <span class="ot">FALSE</span>       <span class="ot">NA</span>      <span class="fl">0.000</span>     <span class="ot">TRUE</span> <span class="dv">2002-02-20</span>       <span class="dv">3</span></span>
<span id="c1-10"><a href="#c1-10" aria-hidden="true"></a>  factor2</span>
<span id="c1-11"><a href="#c1-11" aria-hidden="true"></a><span class="dv">1</span>     <span class="dv">101</span></span>
<span id="c1-12"><a href="#c1-12" aria-hidden="true"></a><span class="dv">2</span>     <span class="dv">102</span></span>
<span id="c1-13"><a href="#c1-13" aria-hidden="true"></a><span class="dv">3</span>     <span class="dv">101</span></span>
<span id="c1-14"><a href="#c1-14" aria-hidden="true"></a><span class="dv">4</span>     <span class="dv">103</span></span>
<span id="c1-15"><a href="#c1-15" aria-hidden="true"></a><span class="dv">5</span>     <span class="dv">102</span></span>
<span id="c1-16"><a href="#c1-16" aria-hidden="true"></a><span class="dv">6</span>    <span class="op">&lt;</span><span class="ot">NA</span><span class="op">&gt;</span></span></code></pre></div>
<p>This is an integer column but it has an ‘codelist’ property set which points to a Data Resource in the Data Package. It is possible te get this code list</p>
<div class="sourceCode" id="c2"><pre class="sourceCode R"><code class="sourceCode r"><span id="c2-1"><a href="#c2-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">dpcodelist</span>(complex<span class="op">$</span>factor1)</span>
<span id="c2-2"><a href="#c2-2" aria-hidden="true"></a>  code     label</span>
<span id="c2-3"><a href="#c2-3" aria-hidden="true"></a><span class="dv">1</span>    <span class="dv">1</span>    Purple</span>
<span id="c2-4"><a href="#c2-4" aria-hidden="true"></a><span class="dv">2</span>    <span class="dv">2</span>       Red</span>
<span id="c2-5"><a href="#c2-5" aria-hidden="true"></a><span class="dv">3</span>    <span class="dv">3</span>     Other</span>
<span id="c2-6"><a href="#c2-6" aria-hidden="true"></a><span class="dv">4</span>    <span class="dv">0</span> Not given</span></code></pre></div>
<p>This Code List can also be used to convert the field to factor:</p>
<div class="sourceCode" id="c3"><pre class="sourceCode R"><code class="sourceCode r"><span id="c3-1"><a href="#c3-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">dptofactor</span>(complex<span class="op">$</span>factor1)</span>
<span id="c3-2"><a href="#c3-2" aria-hidden="true"></a>[<span class="dv">1</span>] Purple Red    Purple Other  <span class="op">&lt;</span><span class="ot">NA</span><span class="op">&gt;</span><span class="st">   </span>Other </span>
<span id="c3-3"><a href="#c3-3" aria-hidden="true"></a><span class="kw">attr</span>(,<span class="st">&quot;fielddescriptor&quot;</span>)</span>
<span id="c3-4"><a href="#c3-4" aria-hidden="true"></a>Field Descriptor<span class="op">:</span></span>
<span id="c3-5"><a href="#c3-5" aria-hidden="true"></a>name    <span class="op">:</span><span class="st">&quot;factor1&quot;</span></span>
<span id="c3-6"><a href="#c3-6" aria-hidden="true"></a>type    <span class="op">:</span><span class="st">&quot;integer&quot;</span></span>
<span id="c3-7"><a href="#c3-7" aria-hidden="true"></a>codelist<span class="op">:</span><span class="st">&quot;codelist-factor1&quot;</span></span>
<span id="c3-8"><a href="#c3-8" aria-hidden="true"></a>Levels<span class="op">:</span><span class="st"> </span>Purple Red Other Not given</span></code></pre></div>
<p>Using the <code>to_factor = TRUE</code> argument of the <code>csv_reader</code> it is also possible to convert all fields which have an associated ‘codelist’ to factor:</p>
<div class="sourceCode" id="c4"><pre class="sourceCode R"><code class="sourceCode r"><span id="c4-1"><a href="#c4-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span>complex &lt;-<span class="st"> </span><span class="kw">dpresource</span>(dp, <span class="st">&quot;complex&quot;</span>) <span class="op">|</span><span class="er">&gt;</span><span class="st"> </span><span class="kw">dpgetdata</span>(<span class="dt">to_factor =</span> <span class="ot">TRUE</span>)</span>
<span id="c4-2"><a href="#c4-2" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">print</span>(complex)</span>
<span id="c4-3"><a href="#c4-3" aria-hidden="true"></a>  string1 integer1 boolean1  number1    number2 boolean2      date1 factor1</span>
<span id="c4-4"><a href="#c4-4" aria-hidden="true"></a><span class="dv">1</span>       a        <span class="dv">1</span>     <span class="ot">TRUE</span>  <span class="fl">1.2e+00</span>      <span class="fl">1.200</span>     <span class="ot">TRUE</span> <span class="dv">2020-01-01</span>  Purple</span>
<span id="c4-5"><a href="#c4-5" aria-hidden="true"></a><span class="dv">2</span>       b     <span class="dv">-100</span>    <span class="ot">FALSE</span> <span class="fl">-1.0e-04</span>     <span class="fl">-0.001</span>    <span class="ot">FALSE</span> <span class="dv">2022-01-12</span>     Red</span>
<span id="c4-6"><a href="#c4-6" aria-hidden="true"></a><span class="dv">3</span>       c       <span class="ot">NA</span>     <span class="ot">TRUE</span>      <span class="ot">Inf</span>   <span class="fl">1100.000</span>     <span class="ot">TRUE</span>       <span class="op">&lt;</span><span class="ot">NA</span><span class="op">&gt;</span><span class="st">  </span>Purple</span>
<span id="c4-7"><a href="#c4-7" aria-hidden="true"></a><span class="dv">4</span>              <span class="dv">100</span>     <span class="ot">TRUE</span>  <span class="fl">1.0e+04</span> <span class="fl">-11000.400</span>       <span class="ot">NA</span> <span class="dv">1950-10-10</span>   Other</span>
<span id="c4-8"><a href="#c4-8" aria-hidden="true"></a><span class="dv">5</span>       f        <span class="dv">0</span>       <span class="ot">NA</span>      <span class="ot">NaN</span>         <span class="ot">NA</span>    <span class="ot">FALSE</span> <span class="dv">1920-12-10</span>    <span class="op">&lt;</span><span class="ot">NA</span><span class="op">&gt;</span></span>
<span id="c4-9"><a href="#c4-9" aria-hidden="true"></a><span class="dv">6</span>       g        <span class="dv">0</span>    <span class="ot">FALSE</span>       <span class="ot">NA</span>      <span class="fl">0.000</span>     <span class="ot">TRUE</span> <span class="dv">2002-02-20</span>   Other</span>
<span id="c4-10"><a href="#c4-10" aria-hidden="true"></a>   factor2</span>
<span id="c4-11"><a href="#c4-11" aria-hidden="true"></a><span class="dv">1</span>   circle</span>
<span id="c4-12"><a href="#c4-12" aria-hidden="true"></a><span class="dv">2</span>   square</span>
<span id="c4-13"><a href="#c4-13" aria-hidden="true"></a><span class="dv">3</span>   circle</span>
<span id="c4-14"><a href="#c4-14" aria-hidden="true"></a><span class="dv">4</span> triangle</span>
<span id="c4-15"><a href="#c4-15" aria-hidden="true"></a><span class="dv">5</span>   square</span>
<span id="c4-16"><a href="#c4-16" aria-hidden="true"></a><span class="dv">6</span>     <span class="op">&lt;</span><span class="ot">NA</span><span class="op">&gt;</span></span></code></pre></div>
<h2 id="creating-a-data-package">Creating a Data Package</h2>
<p>This is shown in a seperate vignette <code>Creating a Data Package</code></p>
<h2 id="quickly-saving-to-and-reading-from-a-data-package">Quickly saving to and reading from a Data Package</h2>
<p>A quick way to create a Data Package from a given dataset is with the <code>dpsaveasdatapackage</code> function:</p>
<div class="sourceCode" id="q1"><pre class="sourceCode R"><code class="sourceCode r"><span id="q1-1"><a href="#q1-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span>dir &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</span>
<span id="q1-2"><a href="#q1-2" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">data</span>(iris)</span>
<span id="q1-3"><a href="#q1-3" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">dpsaveasdatapackage</span>(iris, dir)</span></code></pre></div>
<p>And for reading:</p>
<div class="sourceCode" id="q2"><pre class="sourceCode R"><code class="sourceCode r"><span id="q2-1"><a href="#q2-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">dploadfromdatapackage</span>(dir) <span class="op">|</span><span class="er">&gt;</span><span class="st"> </span><span class="kw">head</span>()</span>
<span id="q2-2"><a href="#q2-2" aria-hidden="true"></a>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span id="q2-3"><a href="#q2-3" aria-hidden="true"></a><span class="dv">1</span>          <span class="fl">5.1</span>         <span class="fl">3.5</span>          <span class="fl">1.4</span>         <span class="fl">0.2</span>       <span class="dv">1</span></span>
<span id="q2-4"><a href="#q2-4" aria-hidden="true"></a><span class="dv">2</span>          <span class="fl">4.9</span>         <span class="fl">3.0</span>          <span class="fl">1.4</span>         <span class="fl">0.2</span>       <span class="dv">1</span></span>
<span id="q2-5"><a href="#q2-5" aria-hidden="true"></a><span class="dv">3</span>          <span class="fl">4.7</span>         <span class="fl">3.2</span>          <span class="fl">1.3</span>         <span class="fl">0.2</span>       <span class="dv">1</span></span>
<span id="q2-6"><a href="#q2-6" aria-hidden="true"></a><span class="dv">4</span>          <span class="fl">4.6</span>         <span class="fl">3.1</span>          <span class="fl">1.5</span>         <span class="fl">0.2</span>       <span class="dv">1</span></span>
<span id="q2-7"><a href="#q2-7" aria-hidden="true"></a><span class="dv">5</span>          <span class="fl">5.0</span>         <span class="fl">3.6</span>          <span class="fl">1.4</span>         <span class="fl">0.2</span>       <span class="dv">1</span></span>
<span id="q2-8"><a href="#q2-8" aria-hidden="true"></a><span class="dv">6</span>          <span class="fl">5.4</span>         <span class="fl">3.9</span>          <span class="fl">1.7</span>         <span class="fl">0.4</span>       <span class="dv">1</span></span></code></pre></div>
<p>This will either load the Data Resource with the same name as the Data Package or the first resource in the Data Package. It is also possible to specify the name of the Data Resource that should be read. Additional arguments are passed on to <code>dpgetdata</code>:</p>
<div class="sourceCode" id="q2"><pre class="sourceCode R"><code class="sourceCode r"><span id="q2-1"><a href="#q2-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">dploadfromdatapackage</span>(dir, <span class="st">&quot;iris&quot;</span>, <span class="dt">to_factor =</span> <span class="ot">TRUE</span>, <span class="dt">use_fread =</span> <span class="ot">TRUE</span>)</span>
<span id="q2-2"><a href="#q2-2" aria-hidden="true"></a>Loading required namespace<span class="op">:</span><span class="st"> </span>data.table</span>
<span id="q2-3"><a href="#q2-3" aria-hidden="true"></a> </span>
<span id="q2-4"><a href="#q2-4" aria-hidden="true"></a>     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species</span>
<span id="q2-5"><a href="#q2-5" aria-hidden="true"></a>  <span class="dv">1</span><span class="op">:</span><span class="st">          </span><span class="fl">5.1</span>         <span class="fl">3.5</span>          <span class="fl">1.4</span>         <span class="fl">0.2</span>    setosa</span>
<span id="q2-6"><a href="#q2-6" aria-hidden="true"></a>  <span class="dv">2</span><span class="op">:</span><span class="st">          </span><span class="fl">4.9</span>         <span class="fl">3.0</span>          <span class="fl">1.4</span>         <span class="fl">0.2</span>    setosa</span>
<span id="q2-7"><a href="#q2-7" aria-hidden="true"></a>  <span class="dv">3</span><span class="op">:</span><span class="st">          </span><span class="fl">4.7</span>         <span class="fl">3.2</span>          <span class="fl">1.3</span>         <span class="fl">0.2</span>    setosa</span>
<span id="q2-8"><a href="#q2-8" aria-hidden="true"></a>  <span class="dv">4</span><span class="op">:</span><span class="st">          </span><span class="fl">4.6</span>         <span class="fl">3.1</span>          <span class="fl">1.5</span>         <span class="fl">0.2</span>    setosa</span>
<span id="q2-9"><a href="#q2-9" aria-hidden="true"></a>  <span class="dv">5</span><span class="op">:</span><span class="st">          </span><span class="fl">5.0</span>         <span class="fl">3.6</span>          <span class="fl">1.4</span>         <span class="fl">0.2</span>    setosa</span>
<span id="q2-10"><a href="#q2-10" aria-hidden="true"></a> <span class="op">---</span><span class="st">                                                            </span></span>
<span id="q2-11"><a href="#q2-11" aria-hidden="true"></a><span class="dv">146</span><span class="op">:</span><span class="st">          </span><span class="fl">6.7</span>         <span class="fl">3.0</span>          <span class="fl">5.2</span>         <span class="fl">2.3</span> virginica</span>
<span id="q2-12"><a href="#q2-12" aria-hidden="true"></a><span class="dv">147</span><span class="op">:</span><span class="st">          </span><span class="fl">6.3</span>         <span class="fl">2.5</span>          <span class="fl">5.0</span>         <span class="fl">1.9</span> virginica</span>
<span id="q2-13"><a href="#q2-13" aria-hidden="true"></a><span class="dv">148</span><span class="op">:</span><span class="st">          </span><span class="fl">6.5</span>         <span class="fl">3.0</span>          <span class="fl">5.2</span>         <span class="fl">2.0</span> virginica</span>
<span id="q2-14"><a href="#q2-14" aria-hidden="true"></a><span class="dv">149</span><span class="op">:</span><span class="st">          </span><span class="fl">6.2</span>         <span class="fl">3.4</span>          <span class="fl">5.4</span>         <span class="fl">2.3</span> virginica</span>
<span id="q2-15"><a href="#q2-15" aria-hidden="true"></a><span class="dv">150</span><span class="op">:</span><span class="st">          </span><span class="fl">5.9</span>         <span class="fl">3.0</span>          <span class="fl">5.1</span>         <span class="fl">1.8</span> virginica</span></code></pre></div>
</body>
</html>
